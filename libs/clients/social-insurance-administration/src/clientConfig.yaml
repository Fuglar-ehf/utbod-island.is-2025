openapi: 3.0.0
info:
  title: Social Insurance Administration API
  version: 1.0.0
  contact:
    name: Social Insurance Administration (Tryggingastofnun)
servers:
  - url: https://xroad-dev.tr.is/r1/IS-DEV/GOV/10008/TR-Protected/
    description: Optional server description, XROAD-DEV
  - url: https://xroad.tr.is/r1/IS-DEV/GOV/10008/TR-Protected/
    description: Optional server description, XROAD-PROD
paths:
  /Test/hello:
    get:
      tags:
        - Hello Oddur
      operationId: hello_oddur
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TestHello'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                type: string
        '500':
          description: internal Error
          content:
            application/json:
              schema:
                type: string
  /Status/oldagepension:
    get:
      tags:
        - Get status
      operationId: get_status
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Status'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                type: string
        '500':
          description: internal Error
          content:
            application/json:
              schema:
                type: string
  /Application:
    post:
      tags:
        - Send application
      operationId: OldAgePension_SendApplication
      requestBody:
        x-name: parentalLeave
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OldAgePension'
        required: true
        x-nullable: true
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OldAgePensionResponse'
        '500':
            description: internal Error
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/OldAgePensionResponseError' 
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
  schemas:
    TestHello:
      type: string
      example: true
      description: Hello from the Oddur side
    Application:
      type: object
      description: Application
      properties:
        applicationType:
          type: string
        applicationSubType:
          type: string
        applicationStatus:
          type: string
        applicationCreateDate:
          format: date-time
          type: string
    OldAgePension:
      properties:
        period:
          $ref: '#/components/schemas/Period'
        comment: 
          type: string
        paymentInfo:
          $ref: '#/components/schemas/PaymentInfo'
        applicantInfo:
          $ref: '#/components/schemas/ApplicantInfo'
        applicationType: 
          type: string
        hasAbroadResidence: 
          type: boolean
        hasOneTimePayment: 
          type: boolean
        isSailorPension:
          type: boolean
        isEarlyPension:
          type: boolean
        householdSupplement:
           $ref: '#/components/schemas/HouseholdSupplement'
        children:
          type: array
          items:
            $ref: '#/components/schemas/Child'
        connectedApplications:
          type: array
          items:
            type: string
        uploads:
          type: object
          additionalProperties: false
          properties:
            pension:
              type: array
              items:
                $ref: '#/components/schemas/File'
            additional:
              type: array
              items:
                $ref: '#/components/schemas/File'
            childPension:
              type: array
              items:
                $ref: '#/components/schemas/File'
            earlyRetirement:
              type: array
              items:
                $ref: '#/components/schemas/File'
            sailorPension:
              type: array
              items:
                $ref: '#/components/schemas/File'
            householdSupplement:
              type: array
              items:
                $ref: '#/components/schemas/File'
            halfOldAgePension:
              type: array
              items:
                $ref: '#/components/schemas/File'
    Period:
      type: object
      additionalProperties: false
      required:
        - year
        - month
      properties:
        year:
          type: integer
          format: int32e
        month:
          type: integer
          format: int32e
    PaymentInfo:
      type: object
      additionalProperties: false
      required:
        - bank
        - taxLevel
        - spouseAllowance
        - personalAllowance
      properties:
        bank: 
          type: string
        taxLevel: 
          type: number
        spouseAllowance: 
          type: boolean
        personalAllowance: 
          type: boolean
        spouseAllowanceUsage: 
          type: number
          format: float
        personalAllowanceUsage:
          type: number
          format: float
    ApplicantInfo:
      type: object
      additionalProperties: false
      required:
        - email
        - phonenumber
      properties:
        email: 
          type: string
        phonenumber: 
          type: string
    HouseholdSupplement:
      type: object
      additionalProperties: false
      required:
        - isRental
        - childrenUnder18
      properties:
        isRental: 
          type: boolean
        childrenUnder18: 
          type: boolean
    Child:
      type: object
      additionalProperties: false
      required:
        - nationalIdOrBirthDate
      properties:
        name:
          type: string
        nationalIdOrBirthDate:
          type: string
        childDoesNotHaveNationalId:
          type: boolean
    File:
      type: object
      additionalProperties: false
      required:
        - name
        - type 
        - file
      properties:
        name: 
          type: string
        type: 
          type: string
        file: 
          type: string
    OldAgePensionResponse:
      type: object
      properties:
        applicationLineId:
          type: number
    OldAgePensionResponseError:
      type: object
      properties:
        code: 
          type: number
        message: 
          type: string
        errors:
          type: array
          items:
             $ref: '#/components/schemas/Error'
    Error:
      type: object
      properties:
        code:
          type: number
        message: 
          type: string
        help: 
          type: string
        trackingId: 
          type: string
        param: 
          type: string
    Status:
      type: object
      description: The status of the applicant applications at TR, if the applicant has one
      properties:
        hasPension:
          type: boolean
        applications:
          type: array
          items:
            $ref: '#/components/schemas/Application'
security:
  - bearerAuth: []
