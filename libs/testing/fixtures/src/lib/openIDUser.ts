import * as randomString from 'randomstring'
import { User } from 'oidc-client'

const defaultValues: User = {
  id_token: randomString.generate(),
  access_token: randomString.generate(),
  token_type: randomString.generate(),
  scope: randomString.generate(),
  profile: {
    name: randomString.generate(),
    nationalId: randomString.generate({ length: 10, charset: 'numeric' }),
    given_name: randomString.generate(),
    family_name: randomString.generate(),
    nickname: randomString.generate(),
    preferred_username: randomString.generate(),
    profile: randomString.generate(),
    picture: randomString.generate(),
    phone_number: randomString.generate({ length: 7, charset: 'numeric' }),
    phone_number_verified: true,
    email: `${randomString.generate()}@example.com`,
    iss: randomString.generate(),
    sub: randomString.generate(),
    aud: randomString.generate(),
    exp: 0,
    iat: 0,
    nonce: 0,
  },
  expires_at: 0,
  state: randomString.generate(),
  toStorageString: () => '',
  expires_in: 0,
  expired: false,
  scopes: [],
}

export const createOpenIDUser = ({
  id_token = defaultValues.id_token,
  access_token = defaultValues.access_token,
  token_type = defaultValues.token_type,
  scope = defaultValues.scope,
  profile = defaultValues.profile,
  expires_at = defaultValues.expires_at,
  state = defaultValues.state,
  toStorageString = defaultValues.toStorageString,
  expires_in = defaultValues.expires_in,
  expired = defaultValues.expired,
  scopes = defaultValues.scopes,
}: User = defaultValues): User => ({
  id_token,
  access_token,
  token_type,
  scope,
  profile,
  expires_at,
  state,
  toStorageString,
  expires_in,
  expired,
  scopes,
})
