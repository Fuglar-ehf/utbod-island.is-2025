#!/bin/bash
declare -A TIME_KEEP
# t <target> - get elapsed time in milliseconds since first invocation (with nanosecond precision)
t() { if [[ -v TIME_KEEP[$1] ]]; then echo "$((${TIME_KEEP[$1]} / 1000000))"; else TIME_KEEP[$1]=$(date +%N); fi; }
set -euo pipefail

# global

export NODE_OPTIONS="--max-old-space-size=8192"

# MacOS specific

export REDIS_CLUSTER_IP=0.0.0.0

# developer custom direnv config

source_env_if_exists .envrc.private
if [[ "${IS_DEVCONTAINER:-}" == true ]]; then
  source_env_if_exists .devcontainer/.envrc.private
fi

# Podman compatibility
# NOTE: Exits direnv if user is using docker.
source_env_if_exists .env.podman

# AWS/Kubernetes
source_env_if_exists .envrc.kube
