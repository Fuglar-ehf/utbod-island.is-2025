# Error Handling

This document describes how REST APIs should present errors to clients consuming their services.

When an error occurs in a API, the service should return the error to the calling client in an informative and structured manner. The API should return information about the error in the response body.

## Response body

When an error occurs, a REST API should respond with an 4xx or 5xx [HTTP status code](http-status-codes.md) and the response should contain a Problem Details object as described in the [IETF RFC7807 documentation](https://datatracker.ietf.org/doc/html/rfc7807).

### Error object

The response should contain the key `error` and it's value should be a JSON object containing at least the two keys, `code` and `message`. If there were multiple errors, the values of `code` and `message` should describe the first error.

- `type` _(string)_ A URI reference that identifies the
  problem type. This specification encourages that, when
  dereferenced, it provides human-readable documentation for the
  problem type.
- `title` _(string)_ A short human-readable summary of the problem type. It
  SHOULD NOT change from occurrence to occurrence.
- `status` _(number)_ The HTTP Status Code generated by the origin server for
  this occurrence of the problem.
- `detail` _(string)_ A human-readable explanation of the problem. This MAY
  differ from occurrence to occurrence.
- `instance` _(string)_ A URI reference that identifies the specific
  occurrence of the problem.
- `extensions` **(Optional)** Any Problem Detail object can contain custom
  extensions specific to the REST API.
  - `traceId` _(string)_ A very common custom extension used to further clarify
    the context in which the error occurred.
  - `params` _(Array)_ A common custom extension used to indicate which
    parameters were being used when the error occurred.

### REST error response examples

Simple response

```javascript
{
  "type": "https://example.com/probs/out-of-credit",
  "title": "You do not have enough credit.",
  "status": 403,
  "detail": "Your current balance is 30, but that costs 50.",
  "instance": "/account/12345/msgs/abc"
}
```

Response with extensions

```javascript
{
  "type": "https://example.com/probs/out-of-credit",
  "title": "You do not have enough credit.",
  "status": 403,
  "detail": "Your current balance is 30, but that costs 50.",
  "instance": "/account/12345/msgs/abc",
  "traceId": "7kHPSP_X0W1R0fo5h0fG",
  "balance": 30,
  "accounts": [
    {
      "owner": 587,
      "path": "/account/12345"
    },
    {
      "owner": 587,
      "path": "/account/67890"
    }
  ]
}
```
